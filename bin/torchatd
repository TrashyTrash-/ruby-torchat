#! /usr/bin/env ruby
require 'optparse'
require 'torchat'

options = {}

OptionParser.new do |o|
	options[:config] = File.expand_path '~/.torchat/torchat.yml'

	o.on '-c', '--config PATH', 'the path to the config file' do |path|
		options[:config] = path
	end
end.parse!

EM.run {
	Torchat.new(options[:config]).start {|s|
		s.on :connection do |buddy|
			puts "#{buddy.id} connected"
		end

		s.on :verification do |buddy|
			puts "#{buddy.id} has been verified"
		end

		s.on :disconnection do |buddy|
			puts "#{buddy.id} disconnected"
		end

		s.on :message do |message|

		end
	}

	puts 'TorChat started'
}
